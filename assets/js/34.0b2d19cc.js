(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{193:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"how-to-install-celery"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#how-to-install-celery","aria-hidden":"true"}},[t._v("#")]),t._v(" How to install Celery")]),t._v(" "),s("h2",{attrs:{id:"install-the-extra"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#install-the-extra","aria-hidden":"true"}},[t._v("#")]),t._v(" Install the extra")]),t._v(" "),s("p",[t._v("To install celery related dependencies, django-zero provides an extra dependency.")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ pip "),s("span",{attrs:{class:"token function"}},[t._v("install")]),t._v(" django-zero"),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("celery"),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("p",[t._v("You can combine extra dependencies, for example")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ pip "),s("span",{attrs:{class:"token function"}},[t._v("install")]),t._v(" django-zero"),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("celery,dev"),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("p",[t._v("Of course, you can also setup the celery dependencies yourself, if you prefer to\nhave more fine-grained control over the requirements.")]),t._v(" "),s("h2",{attrs:{id:"create-the-celery-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-the-celery-configuration","aria-hidden":"true"}},[t._v("#")]),t._v(" Create the celery configuration")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" celery "),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Celery\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" django_zero\n\ndjango_zero"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("configure"),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("os"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dirname"),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("os"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dirname"),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__file__"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" Celery"),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"config"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config_from_object"),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"django.conf:settings"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" namespace"),s("span",{attrs:{class:"token operator"}},[t._v("=")]),s("span",{attrs:{class:"token string"}},[t._v('"CELERY"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("autodiscover_tasks"),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n@app"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("task"),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bind"),s("span",{attrs:{class:"token operator"}},[t._v("=")]),s("span",{attrs:{class:"token boolean"}},[t._v("True")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("debug_task")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("print")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"Request: {0!r}"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token builtin"}},[t._v("format")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"tune-django-settings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tune-django-settings","aria-hidden":"true"}},[t._v("#")]),t._v(" Tune django settings")]),t._v(" "),s("p",[t._v("You can tune celery settings in "),s("code",[t._v("config/settings.py")]),t._v(", uppercasing and prefixing the celery settings\nwith "),s("code",[t._v("CELERY_")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("# Celery")]),t._v("\nCELERY_BEAT_SCHEDULE "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nCELERY_BEAT_SCHEDULER "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"django_celery_beat.schedulers:DatabaseScheduler"')]),t._v("\nCELERY_RESULT_BACKEND "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"django-db"')]),t._v("\nCELERY_TIMEZONE "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" TIME_ZONE\n")])])]),s("h2",{attrs:{id:"enable-the-feature"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#enable-the-feature","aria-hidden":"true"}},[t._v("#")]),t._v(" Enable the feature")]),t._v(" "),s("p",[t._v("Open "),s("code",[t._v("config/__init__.py")]),t._v(" and add:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("# Celery")]),t._v("\nos"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("environ"),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{attrs:{class:"token string"}},[t._v('"ENABLE_CELERY"')]),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" os"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("environ"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'ENABLE_CELERY'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'true'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" config"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("celery "),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" app\n")])])]),s("ul",[s("li",[t._v("Ensure celery app is loaded.")]),t._v(" "),s("li",[t._v("Adds celery processes to django-zero managed processes.")])]),t._v(" "),s("h2",{attrs:{id:"running-in-development"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-in-development","aria-hidden":"true"}},[t._v("#")]),t._v(" Running in development")]),t._v(" "),s("p",[t._v("Now, by default, running the django-zero development server will spawn two more processes.")]),t._v(" "),s("ul",[s("li",[t._v("Celery worker: to actually do things")]),t._v(" "),s("li",[t._v("Celery beat: to schedule things")])]),t._v(" "),s("p",[t._v("If you don't want those processes to run, you can always disable the feature temporarily:")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ ENABLE_CELERY"),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("false django-zero start\n")])])]),s("p",[t._v("Or using make...")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ ENABLE_CELERY"),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("false "),s("span",{attrs:{class:"token function"}},[t._v("make")]),t._v("\n")])])])])}],!1,null,null,null);e.options.__file="install-celery.md";a.default=e.exports}}]);